#### HashMap的极限情况在放多少个数据的时候会形成红黑二叉树？11个

![](D:\MyWork\BigData\img\HashMap底层结构.png)

```java
jdk1.8之后，HashMap底层是数组+链表的形式。
数组在极限情况下，即只往一个格子中放数据：
假设都往0号格子中放数据，当放到8个的时候，链表不会发生变化；
当放第9个的时候，它会判断是不是当前数组的容量太小，此时会扩容：16*2=32；
当放第10个的时候，它又会判断当前数组的容量是否还是太小，于是再次扩容：32*2=64；
当放第11个的时候，依然会判断数组容量，但这次不会扩容，它会觉得当前的结构有问题，于是
形成红黑二叉树，因为当链表长度太长时，查询效率太低
```

#### 数据存放位置的经验

```java
数据存放位置的经验：
比如：hashmap : hash(key.hashcode) & (length - 1)
当框架当中的容量为2^n时，使用按位与的方式，如：hash(key.hashcode) & (length - 1)；
当框架当中容量不是2^n时，使用取模的方式，如kafka往不同topic的分区中放数据时。
```

